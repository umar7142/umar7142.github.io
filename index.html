<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>TremorTrack | Global OSINT by Umer Asif</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <style>
        /* üåã PREMIUM GLASSMORPHISM THEME */
        :root {
            --bg-dark: #050505; --text-main: #f8fafc; --text-muted: #94a3b8;
            --accent-red: #ef4444; --accent-orange: #f97316; --accent-yellow: #eab308;
            --glass-bg: rgba(15, 23, 42, 0.7); --glass-border: rgba(255, 255, 255, 0.08);
        }

        @keyframes pulseAlert { 0% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0.7); } 70% { box-shadow: 0 0 0 15px rgba(239, 68, 68, 0); } 100% { box-shadow: 0 0 0 0 rgba(239, 68, 68, 0); } }
        @keyframes fadeOut { from { opacity: 1; } to { opacity: 0; visibility: hidden; } }
        @keyframes spin { 100% { transform: rotate(360deg); } }

        body { margin: 0; padding: 0; background-color: var(--bg-dark); color: var(--text-main); font-family: 'Inter', sans-serif; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }

        /* üîÑ LOADING SCREEN */
        #loader { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: #050505; z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; transition: opacity 0.5s ease; }
        .spinner { width: 50px; height: 50px; border: 3px solid rgba(239, 68, 68, 0.2); border-top-color: var(--accent-red); border-radius: 50%; animation: spin 1s linear infinite; margin-bottom: 20px; }
        #loader h2 { color: var(--accent-red); font-weight: 600; letter-spacing: 2px; text-transform: uppercase; font-size: 14px;}

        /* üîù TOP NAVIGATION (GLASS) */
        header { display: flex; align-items: center; justify-content: space-between; padding: 15px 30px; background: var(--glass-bg); backdrop-filter: blur(16px); -webkit-backdrop-filter: blur(16px); border-bottom: 1px solid var(--glass-border); z-index: 1000; position: relative; }
        
        .brand-container { display: flex; align-items: center; gap: 15px; }
        .custom-logo { width: 40px; height: 40px; display: flex; align-items: center; justify-content: center; background: rgba(239, 68, 68, 0.15); border-radius: 10px; border: 1px solid rgba(239, 68, 68, 0.5); animation: pulseAlert 2s infinite;}
        .custom-logo i { font-size: 20px; color: var(--accent-red); }
        header h1 { margin: 0; font-size: 24px; font-weight: 800; letter-spacing: -0.5px; }
        header h1 span { font-weight: 400; color: var(--text-muted); font-size: 16px; margin-left: 8px; }

        .system-status { display: flex; gap: 12px; font-size: 13px; font-weight: 600; color: #10b981; align-items: center; background: rgba(16, 185, 129, 0.1); padding: 8px 16px; border-radius: 20px; border: 1px solid rgba(16, 185, 129, 0.3);}
        .live-dot { border-radius: 50%; width: 8px; height: 8px; background: #10b981; box-shadow: 0 0 8px #10b981;}

        /* üóÇÔ∏è MAIN LAYOUT */
        #radar-view { display: flex; flex: 1; overflow: hidden; position: relative; }

        /* üåç MAP AREA */
        #map { flex: 1; background: #050505; z-index: 1; }

        /* üì± FLOATING SIDEBAR (GLASSMORPHISM) */
        .sidebar { position: absolute; top: 20px; left: 20px; width: 360px; height: calc(100vh - 120px); background: var(--glass-bg); backdrop-filter: blur(20px); -webkit-backdrop-filter: blur(20px); border: 1px solid var(--glass-border); border-radius: 16px; display: flex; flex-direction: column; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.5); z-index: 10; overflow: hidden; }
        
        .sidebar-content { padding: 25px; flex: 1; overflow-y: auto; display: flex; flex-direction: column; gap: 20px;}
        .sidebar-content::-webkit-scrollbar { width: 4px; }
        .sidebar-content::-webkit-scrollbar-thumb { background: var(--glass-border); border-radius: 4px; }

        .section-title { margin: 0; font-size: 12px; text-transform: uppercase; color: var(--text-muted); font-weight: 700; letter-spacing: 1.5px; display: flex; align-items: center; gap: 8px;}
        
        /* üìä STAT CARDS */
        .stat-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; }
        .stat-card { background: rgba(255, 255, 255, 0.03); border: 1px solid var(--glass-border); padding: 15px; border-radius: 12px; transition: transform 0.2s; }
        .stat-card:hover { transform: translateY(-2px); background: rgba(255, 255, 255, 0.05); }
        .stat-card h3 { margin: 0 0 8px 0; font-size: 11px; color: var(--text-muted); font-weight: 600; text-transform: uppercase; }
        .stat-card p { margin: 0; font-size: 24px; font-weight: 800; color: var(--text-main); }
        .stat-card.danger p { color: var(--accent-red); }
        
        .max-mag-card { grid-column: span 2; background: linear-gradient(135deg, rgba(239, 68, 68, 0.1) 0%, rgba(249, 115, 22, 0.05) 100%); border-color: rgba(239, 68, 68, 0.3); display: flex; justify-content: space-between; align-items: center;}
        .max-mag-card p { color: var(--accent-orange); }

        /* üìú LIVE FEED (With Neon Classes) */
        .live-list { list-style: none; padding: 0; margin: 0; display: flex; flex-direction: column; gap: 10px; }
        .live-list li { padding: 15px; background: rgba(0,0,0,0.3); border: 1px solid var(--glass-border); border-radius: 10px; cursor: pointer; transition: 0.2s; position: relative; overflow: hidden; }
        .live-list li:hover { background: rgba(255,255,255,0.05); border-color: rgba(255,255,255,0.2); transform: translateX(5px); }
        
        /* Default Yellow Line */
        .live-list li::before { content: ''; position: absolute; left: 0; top: 0; height: 100%; width: 4px; background: var(--accent-yellow); }
        
        /* üî• THE MAGNITUDE CLASSES üî• */
        .live-list li.high-mag::before { background: var(--accent-red); box-shadow: 0 0 10px var(--accent-red); }
        .high-mag .eq-mag { color: var(--accent-red); font-weight: 900; }
        
        .live-list li.med-mag::before { background: var(--accent-orange); }
        .med-mag .eq-mag { color: var(--accent-orange); font-weight: 800;}

        .eq-mag { font-size: 16px; font-weight: 700; margin-bottom: 6px; display: flex; justify-content: space-between;}
        .eq-loc { color: var(--text-main); font-weight: 500; font-size: 13px; margin-bottom: 6px; line-height: 1.4;}
        .eq-time { color: var(--text-muted); font-size: 11px; display: flex; gap: 5px; align-items: center;}

        /* üßë‚Äçüíª BRANDING FOOTER */
        .branding-footer { padding: 15px 25px; background: rgba(0,0,0,0.5); border-top: 1px solid var(--glass-border); display: flex; align-items: center; justify-content: space-between; }
        .dev-info h4 { margin: 0 0 3px 0; font-size: 13px; color: var(--text-main); font-weight: 700; }
        .dev-info p { margin: 0; font-size: 11px; color: var(--text-muted); display: flex; align-items: center; gap: 4px;}
        .dev-socials { display: flex; gap: 12px; }
        .dev-socials a { color: var(--text-muted); font-size: 16px; transition: 0.2s; }
        .dev-socials a:hover { color: var(--accent-blue); transform: scale(1.1); }

        /* LEAFLET POPUP OVERRIDES */
        .leaflet-popup-content-wrapper { background: rgba(15, 23, 42, 0.9) !important; backdrop-filter: blur(10px); color: #fff !important; border: 1px solid rgba(255,255,255,0.1) !important; border-radius: 12px !important; box-shadow: 0 10px 25px rgba(0,0,0,0.8) !important; font-family: 'Inter', sans-serif;}
        .leaflet-popup-tip { display: none; }

    </style>
</head>
<body>

    <div id="loader">
        <div class="spinner"></div>
        <h2 id="loader-text">Initializing USGS Sat-Link...</h2>
    </div>

    <header>
        <div class="brand-container">
            <div class="custom-logo"><i class="fa-solid fa-house-crack"></i></div>
            <h1>TREMORTRACK <span>| GLOBAL OSINT</span></h1>
        </div>
        <div class="system-status">
            <div class="live-dot"></div>
            <span>USGS SAT-LINK ACTIVE</span>
        </div>
    </header>

    <div id="radar-view">
        <div id="map"></div>
        
        <div class="sidebar">
            <div class="sidebar-content">
                <h2 class="section-title"><i class="fa-solid fa-chart-line"></i> Global Seismic Analytics (24H)</h2>
                
                <div class="stat-grid">
                    <div class="stat-card">
                        <h3>Total Quakes</h3>
                        <p id="total-count">--</p>
                    </div>
                    <div class="stat-card danger">
                        <h3>Mag 5.0+ Alerts</h3>
                        <p id="danger-count">--</p>
                    </div>
                    <div class="stat-card max-mag-card">
                        <div>
                            <h3 style="color: rgba(255,255,255,0.6);">Max Magnitude Today</h3>
                            <p id="max-mag-count">--</p>
                        </div>
                        <i class="fa-solid fa-fire-flame-curved" style="font-size: 28px; color: var(--accent-orange); opacity: 0.5;"></i>
                    </div>
                </div>

                <h2 class="section-title" style="margin-top: 10px;"><i class="fa-solid fa-list-ul"></i> Live Threat Feed</h2>
                <ul class="live-list" id="eq-feed"></ul>
            </div>
            
            <div class="branding-footer">
                <div class="dev-info">
                    <h4>UMER ASIF</h4>
                    <p><i class="fa-solid fa-location-dot" style="color: var(--accent-red);"></i> Rahim Yar Khan, PK</p>
                </div>
                <div class="dev-socials">
                    <a href="#" title="GitHub"><i class="fa-brands fa-github"></i></a>
                    <a href="#" title="X (Twitter)"><i class="fa-brands fa-x-twitter"></i></a>
                    <a href="#" title="LinkedIn"><i class="fa-brands fa-linkedin"></i></a>
                </div>
            </div>
        </div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    
    <script>
        // üó∫Ô∏è 1. LEAFLET SETUP (Dark Theme)
        var map = L.map('map', { zoomControl: false }).setView([20.0, 0.0], 3); 
        L.control.zoom({ position: 'topright' }).addTo(map);
        L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_nolabels/{z}/{x}/{y}{r}.png', { maxZoom: 19 }).addTo(map);
        
        var eqLayer = L.layerGroup().addTo(map);

        function timeAgo(time) {
            let mins = Math.floor((Date.now() - time) / 60000);
            if(mins < 60) return `${mins} mins ago`;
            return `${Math.floor(mins/60)} hrs ago`;
        }

        async function fetchEarthquakes() {
            try {
                // üì° 2. FETCH USGS GEOJSON
                let response = await fetch('https://earthquake.usgs.gov/earthquakes/feed/v1.0/summary/all_day.geojson');
                if(!response.ok) throw new Error("USGS Down");
                
                let data = await response.json();
                let quakes = data.features.filter(eq => eq.properties.mag >= 2.0); // Filter micro-quakes
                
                eqLayer.clearLayers(); 
                const feedContainer = document.getElementById('eq-feed');
                feedContainer.innerHTML = ''; 
                
                let dangerCount = 0;
                let maxMag = 0;

                quakes.forEach(eq => {
                    let mag = parseFloat(eq.properties.mag);
                    if (mag > maxMag) maxMag = mag;

                    let loc = eq.properties.place;
                    let time = eq.properties.time;
                    let coords = eq.geometry.coordinates; 
                    let lat = coords[1], lon = coords[0];

                    let color = '#eab308'; // Default Yellow
                    let listClass = '';
                    
                    // üé® 3. MAGNITUDE LOGIC & CLASSES
                    if (mag >= 5.0) {
                        color = '#ef4444'; // Red
                        dangerCount++;
                        listClass = 'high-mag';
                    } else if (mag >= 4.0) {
                        color = '#f97316'; // Orange
                        listClass = 'med-mag';
                    }

                    // üî¥ PLOT MARKERS ON MAP
                    L.circleMarker([lat, lon], {
                        radius: Math.max(mag * 4, 6),
                        fillColor: color,
                        color: color,
                        weight: 2,
                        opacity: 0.9,
                        fillOpacity: 0.3
                    }).bindPopup(`
                        <div style="text-align:center;">
                            <h2 style="margin:0 0 5px 0; color:${color}; font-size:24px; font-weight:800;">${mag.toFixed(1)} <span style="font-size:12px; color:#94a3b8; font-weight:400;">MAG</span></h2>
                            <p style="margin:0; font-size:13px; border-top:1px solid rgba(255,255,255,0.1); padding-top:8px;">${loc}</p>
                            <p style="margin:5px 0 0 0; font-size:11px; color:#94a3b8;">${new Date(time).toLocaleString()}</p>
                        </div>
                    `).addTo(eqLayer);

                    // üìù UPDATE SIDEBAR LIST
                    if (feedContainer.children.length < 50) {
                        let li = document.createElement('li');
                        li.className = listClass; // Injecting CSS class based on Mag
                        li.innerHTML = `
                            <div class="eq-mag"><span>Mag ${mag.toFixed(1)}</span> <i class="fa-solid fa-satellite-dish" style="font-size:12px; opacity:0.5;"></i></div>
                            <div class="eq-loc">${loc}</div>
                            <div class="eq-time"><i class="fa-regular fa-clock"></i> ${timeAgo(time)}</div>
                        `;
                        li.onclick = () => { map.flyTo([lat, lon], 7, {duration: 1.5}); };
                        feedContainer.appendChild(li);
                    }
                });

                // Update Stats
                document.getElementById('total-count').innerText = quakes.length;
                document.getElementById('danger-count').innerText = dangerCount;
                document.getElementById('max-mag-count').innerText = maxMag.toFixed(1);

                // Hide Loader
                setTimeout(() => { document.getElementById('loader').style.animation = 'fadeOut 0.5s forwards'; }, 800);

            } catch (error) {
                console.error(error);
                document.getElementById('loader-text').innerText = "CONNECTION FAILED. RETRYING...";
                document.getElementById('loader-text').style.color = "#ef4444";
            }
        }

        // Initialize Call
        fetchEarthquakes();
        
        // üîÑ 4. AUTO-REFRESH EVERY 5 MINUTES (300,000 milliseconds)
        setInterval(fetchEarthquakes, 300000); 

    </script>
</body>
</html>
